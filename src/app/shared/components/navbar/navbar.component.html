<div class="navbar" >
  <div class="navbar-left">
    <img src="/images/sarah-bakeryLogo.png" alt="" class="logo">
    <h1 class="logiTitle">Sarah's Bakery</h1>
  </div>

  <!-- Mobile Menu Toggle -->
  <button class="mobile-menu-toggle" (click)="toggleMobileMenu()" [attr.aria-expanded]="showMobileMenu" aria-label="Toggle menu">
    <i class="material-icons">{{ showMobileMenu ? 'close' : 'menu' }}</i>
  </button>

  <!-- Desktop Navigation -->
  <ul class="navbar-center">
    <li routerLink="/home" routerLinkActive="active" [routerLinkActiveOptions]="{exact: false}"><a (click)="closeMobileMenu()">{{ 'nav.home' | translate }}</a></li>
    <li routerLink="/shop" routerLinkActive="active" [routerLinkActiveOptions]="{exact: false}"><a (click)="closeMobileMenu()">{{ 'nav.shop' | translate }}</a></li>
    <li routerLink="/recipe" routerLinkActive="active" [routerLinkActiveOptions]="{exact: false}"><a (click)="closeMobileMenu()">{{ 'nav.recipes' | translate }}</a></li>
    <li routerLink="/about-us" routerLinkActive="active" [routerLinkActiveOptions]="{exact: false}"><a (click)="closeMobileMenu()">{{ 'nav.about' | translate }}</a></li>
    <li routerLink="/contact-us" routerLinkActive="active" [routerLinkActiveOptions]="{exact: false}"><a (click)="closeMobileMenu()">{{ 'nav.contact' | translate }}</a></li>
    <li routerLink="/share-recipe" routerLinkActive="active" [routerLinkActiveOptions]="{exact: false}"><a (click)="closeMobileMenu()">{{ 'nav.share' | translate }}</a></li>
  </ul>

  <!-- Mobile Navigation Overlay -->
  <div class="mobile-menu-overlay" [class.active]="showMobileMenu" (click)="closeMobileMenu()"></div>
  
  <!-- Mobile Navigation Menu -->
  <ul class="mobile-nav" [class.active]="showMobileMenu">
    <li routerLink="/home" routerLinkActive="active" [routerLinkActiveOptions]="{exact: false}"><a (click)="closeMobileMenu()">{{ 'nav.home' | translate }}</a></li>
    <li routerLink="/shop" routerLinkActive="active" [routerLinkActiveOptions]="{exact: false}"><a (click)="closeMobileMenu()">{{ 'nav.shop' | translate }}</a></li>
    <li routerLink="/recipe" routerLinkActive="active" [routerLinkActiveOptions]="{exact: false}"><a (click)="closeMobileMenu()">{{ 'nav.recipes' | translate }}</a></li>
    <li routerLink="/about-us" routerLinkActive="active" [routerLinkActiveOptions]="{exact: false}"><a (click)="closeMobileMenu()">{{ 'nav.about' | translate }}</a></li>
    <li routerLink="/contact-us" routerLinkActive="active" [routerLinkActiveOptions]="{exact: false}"><a (click)="closeMobileMenu()">{{ 'nav.contact' | translate }}</a></li>
    <li routerLink="/share-recipe" routerLinkActive="active" [routerLinkActiveOptions]="{exact: false}"><a (click)="closeMobileMenu()">{{ 'nav.share' | translate }}</a></li>
  </ul>

  <div class="navbar-right">
    @if (enableSearch) {
      <input
        type="search"
        [placeholder]="'nav.search.placeholder' | translate"
        class="search"
        [(ngModel)]="inputSearch"
        (input)="sendProductIdToSearch()"
      >
    }
    <div class="options">
      <button class="icon-btn cart-btn" [title]="'nav.cart' | translate">
        <a routerLink="/cart" class="cart-link">
          <i class="material-icons">shopping_cart</i>
          @if (cartItemCount > 0) {
            <span class="cart-badge">{{ cartItemCount }}</span>
          }
        </a>
      </button>
      <!-- User Menu: Show when logged in -->
      @if (isLoggedIn && userData) {
        <div class="user-menu-container">
          <button class="icon-btn user-profile-btn" (click)="toggleUserMenu()" [title]="userData.name || 'User Profile'">
            @if (userData.photoURL) {
              <img [src]="userData.photoURL" [alt]="userData.name" class="user-avatar" (error)="onImageError($event)">
            }
            @if (!userData.photoURL) {
              <i class="material-icons user">account_circle</i>
            }
            <span class="user-name">{{ userData.name || 'User' }}</span>
          </button>
          @if (showUserMenu) {
            <div class="user-dropdown" (click)="$event.stopPropagation()">
              <div class="user-info">
                @if (userData.photoURL) {
                  <img [src]="userData.photoURL" [alt]="userData.name" class="user-avatar-large" (error)="onImageError($event)">
                }
                @if (!userData.photoURL) {
                  <i class="material-icons">person</i>
                }
            <div class="user-details">
              <span class="user-name-full">{{ userData.name }}</span>
              <span class="user-email">{{ userData.email }}</span>
            </div>
          </div>
          <div class="dropdown-divider"></div>
          <button routerLink="/favorites" class="dropdown-item" (click)="onFavoritesClick()">
            <i class="material-icons">favorite</i>
            <span>{{ 'nav.favorites' | translate }}</span>
          </button>
          @if (isAdmin) {
            <div class="dropdown-divider"></div>
            <div class="admin-section">
              <span class="admin-label">{{ 'nav.admin' | translate }}</span>
            </div>
            <button routerLink="/admin-orders" class="dropdown-item" (click)="closeUserMenu()">
              <i class="material-icons">shopping_bag</i>
              <span>{{ 'nav.adminOrders' | translate }}</span>
            </button>
            <button routerLink="/review-recipes" class="dropdown-item" (click)="closeUserMenu()">
              <i class="material-icons">rate_review</i>
              <span>{{ 'nav.reviewRecipes' | translate }}</span>
            </button>
            <button routerLink="/Showfeedback" class="dropdown-item" (click)="closeUserMenu()">
              <i class="material-icons">feedback</i>
              <span>{{ 'nav.feedback' | translate }}</span>
            </button>
          }
          <button class="dropdown-item" (click)="toggleTheme(); closeUserMenu()">
            <i class="material-icons">{{ currentTheme === 'light' ? 'dark_mode' : 'light_mode' }}</i>
            <span>{{ currentTheme === 'light' ? ('theme.dark' | translate) : ('theme.light' | translate) }}</span>
          </button>
          <button class="dropdown-item" (click)="toggleLanguage(); closeUserMenu()">
            <i class="material-icons">language</i>
            <span>{{ 'language.toggle' | translate: {language: (currentLanguage === 'en' ? ('language.arabic' | translate) : ('language.english' | translate))} }}</span>
          </button>
          <div class="dropdown-divider"></div>
          <button class="dropdown-item" (click)="signOut()">
            <i class="material-icons">logout</i>
            <span>Sign Out</span>
          </button>
        </div>
        }
      </div>
      }

      <!-- Sign In Button: Show when not logged in -->
      @if (!isLoggedIn) {
        <button class="icon-btn" (click)="signin()" title="Sign In">
          <i class="material-icons user">account_circle</i>
        </button>
      }

      @if (activeForm === 'signin') {
        <app-signin
        class = "sign"
        (signSwitch) = "signup()"
        (signClose) = "signClose()"
        (login)="success()"
        ></app-signin>
      }

      @if (activeForm === 'forget') {
        <app-forget
        class = "forget"
        (fClose)="signin()"
        ></app-forget>
      }

      @if (activeForm === 'signup') {
        <app-signup
        class="sign"
        (close) = "signClose()"
        (switch) = "signin()"
        ></app-signup>
      }

      @if (activeForm === 'success') {
        <div class="success">
          <span #loader class="loader"></span>
          <div #check class="spinner">
            <i class="fa fa-check"></i>
          </div>
        </div>
      }

      <!-- @if (isActive) {
        @if (isActive==1){
        }
        @if (isActive==2) {
        }
        @if (isActive == 3){
        }
      } -->


    </div>
  </div>
</div>
