@if (recipe) {
  <div class="recipe-details-container">
  <button class="back-button" (click)="goBack()">
    <i class="material-icons">arrow_back</i>
    <span>{{ 'common.back' | translate }}</span>
  </button>

  <div class="recipe-header">
    <img [src]="recipe.image || 'https://via.placeholder.com/600x400'" [alt]="getTitle()" class="recipe-image">
    <div class="recipe-info">
      <h1 class="recipe-title">{{ getTitle() }}</h1>
      <p class="recipe-description">{{ getDescription() }}</p>
      
      <div class="recipe-meta">
        <div class="meta-item">
          <i class="material-icons">schedule</i>
          <div>
            <span class="meta-label">{{ 'recipe.prepTime' | translate }}</span>
            <span class="meta-value">{{ recipe.prepTime }} {{ 'common.minutes' | translate }}</span>
          </div>
        </div>
        <div class="meta-item">
          <i class="material-icons">timer</i>
          <div>
            <span class="meta-label">{{ 'recipe.cookTime' | translate }}</span>
            <span class="meta-value">{{ recipe.cookTime }} {{ 'common.minutes' | translate }}</span>
          </div>
        </div>
        <div class="meta-item">
          <i class="material-icons">people</i>
          <div>
            <span class="meta-label">{{ 'recipe.servings' | translate }}</span>
            <span class="meta-value">{{ recipe.servings }}</span>
          </div>
        </div>
        <div class="meta-item">
          <i class="material-icons">signal_cellular_alt</i>
          <div>
            <span class="meta-label">{{ 'recipe.difficulty' | translate }}</span>
            <span class="meta-value">{{ getDifficulty() }}</span>
          </div>
        </div>
        <div class="meta-item">
          <i class="material-icons">category</i>
          <div>
            <span class="meta-label">{{ 'recipe.category' | translate }}</span>
            <span class="meta-value">{{ getCategory() }}</span>
          </div>
        </div>
      </div>
    </div>
  </div>

  <div class="recipe-content">
    <div class="ingredients-section">
      <h2 class="section-title">
        <i class="material-icons">shopping_cart</i>
        {{ 'recipe.ingredients' | translate }}
      </h2>
      <ul class="ingredients-list">
        @for (ingredient of getIngredients(); track ingredient) {
          <li>{{ ingredient }}</li>
        }
      </ul>
    </div>

    <div class="instructions-section">
      <h2 class="section-title">
        <i class="material-icons">list</i>
        {{ 'recipe.instructions' | translate }}
      </h2>
      <ol class="instructions-list">
        @for (instruction of getInstructions(); track instruction) {
          <li>{{ instruction }}</li>
        }
      </ol>
    </div>
  </div>
</div>
}

@if (isLoading) {
  <div class="recipe-loading">
    <svg width="120" height="140" viewBox="0 0 120 120" fill="none" xmlns="http://www.w3.org/2000/svg" class="donut-loader">
      <style>
        .donut-bouncer {
          animation: cuteBounce 0.8s ease-in-out infinite;
          transform-origin: center bottom;
        }
        .donut-roller {
          animation: roll 2s linear infinite;
          transform-origin: center;
        }
        .donut-shadow {
          animation: shadowScale 0.8s ease-in-out infinite;
          transform-origin: center;
          opacity: 0.2;
        }
        .face-blink {
          animation: blink 4s infinite;
          transform-origin: center 55px;
        }
        @keyframes roll {
          100% { transform: rotate(360deg); }
        }
        @keyframes cuteBounce {
          0%, 100% { 
            transform: translateY(0) scale(1.05, 0.9);
            animation-timing-function: ease-out;
          }
          50% { 
            transform: translateY(-15px) scale(0.95, 1.05);
            animation-timing-function: ease-in;
          }
        }
        @keyframes shadowScale {
          0%, 100% { transform: scale(1); opacity: 0.2; }
          50% { transform: scale(0.7); opacity: 0.1; }
        }
        @keyframes blink {
          0%, 48%, 52%, 100% { transform: scaleY(1); }
          50% { transform: scaleY(0.1); }
        }
      </style>
      <ellipse cx="60" cy="105" rx="30" ry="5" fill="#000000" class="donut-shadow"/>
      <g class="donut-bouncer">
        <g class="donut-roller">
          <circle cx="60" cy="60" r="36" stroke="#F4D0A9" stroke-width="28" />
          <circle cx="60" cy="60" r="36" stroke="#FFABD6" stroke-width="22" stroke-dasharray="190 40" stroke-linecap="round" transform="rotate(-30 60 60)"/>
          <path d="M45 35 Q 55 30, 65 32" stroke="white" stroke-width="4" stroke-linecap="round" opacity="0.6"/>
          <path d="M80 45 Q 85 55, 82 65" stroke="white" stroke-width="4" stroke-linecap="round" opacity="0.6" transform="rotate(20 60 60)"/>
          <g fill="#FFFFFF">
            <rect x="57" y="22" width="6" height="10" rx="3" fill="#AEEEEE" transform="rotate(15 60 30)"/>
            <rect x="88" y="57" width="10" height="6" rx="3" fill="#FFF68F" transform="rotate(10 94 60)"/>
            <rect x="55" y="88" width="6" height="10" rx="3" fill="#C1FFC1" transform="rotate(-20 58 94)"/>
            <rect x="20" y="55" width="10" height="6" rx="3" fill="#FFDAB9" transform="rotate(-10 26 58)"/>
            <rect x="35" y="35" width="6" height="8" rx="3" fill="#E6E6FA" transform="rotate(45 38 40)"/>
          </g>
          <g class="face-blink">
            <circle cx="50" cy="55" r="4" fill="#4A4A4A"/>
            <circle cx="70" cy="55" r="4" fill="#4A4A4A"/>
            <circle cx="52" cy="53" r="1.5" fill="white"/>
            <circle cx="72" cy="53" r="1.5" fill="white"/>
            <ellipse cx="45" cy="62" rx="3.5" ry="2" fill="#FF69B4" opacity="0.5"/>
            <ellipse cx="75" cy="62" rx="3.5" ry="2" fill="#FF69B4" opacity="0.5"/>
            <path d="M 56 63 Q 60 66, 64 63" stroke="#4A4A4A" stroke-width="2" stroke-linecap="round" fill="none"/>
          </g>
        </g>
      </g>
    </svg>
    <p>{{ 'common.loading' | translate }}</p>
  </div>
}

@if (!recipe && !isLoading) {
  <div class="recipe-not-found">
    <h2>{{ 'common.error' | translate }}</h2>
    <p>{{ 'recipe.notFound' | translate }}</p>
    <button class="back-button" (click)="goBack()">
      <i class="material-icons">arrow_back</i>
      <span>{{ 'common.back' | translate }}</span>
    </button>
  </div>
}

